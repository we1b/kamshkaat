<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÙƒÙ…Ø´ÙƒØ§Ø© | Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</title>
    <link rel="icon" type="image/png" href="images/ui/logo.png">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <script src="js/auth.js"></script>
    <script src="js/main.js"></script>
    <script src="js/dashboard.js"></script>

    <!-- Ø³ØªØ§ÙŠÙ„Ø§Øª Ø®Ø§ØµØ© Ø¨ØªØ­Ø¯ÙŠ Ø±Ù…Ø¶Ø§Ù† -->
    <style>
        .custom-checkbox { appearance: none; -webkit-appearance: none; background-color: #fff; margin: 0; width: 1.5em; height: 1.5em; border: 2px solid #D1D5DB; border-radius: 0.5em; display: grid; place-content: center; cursor: pointer; transition: all 0.2s ease-in-out; }
        .custom-checkbox::before { content: ""; width: 0.8em; height: 0.8em; transform: scale(0); transition: 120ms transform ease-in-out; box-shadow: inset 1em 1em white; transform-origin: center; clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%); }
        .custom-checkbox:checked { background-color: #047857; border-color: #047857; }
        .custom-checkbox:checked::before { transform: scale(1); }
        
        .quran-card { background: linear-gradient(135deg, #047857 0%, #064E3B 100%); color: white; position: relative; overflow: hidden; }
        .quran-card::after { content: ''; position: absolute; top: -20px; left: -20px; width: 100px; height: 100px; background: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 0l2.5 7.5L20 10l-7.5 2.5L10 20l-2.5-7.5L0 10l7.5-2.5z' fill='%23D4AF37' fill-opacity='0.1'/%3E%3C/svg%3E"); opacity: 0.3; }
        
        .toggle-switch { position: relative; display: inline-block; width: 44px; height: 24px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #047857; }
        input:checked + .slider:before { transform: translateX(20px); }
    </style>
</head>
<body data-page="dashboard">
    <div class="fixed-bg"><img src="images/ui/bg.jpg"></div>
    <div id="header-ph"></div>

    <main class="pt-32 px-4 container mx-auto min-h-screen pb-12 fade-in">
        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
            
            <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© -->
            <div class="lg:col-span-1 space-y-6">
                <!-- ÙƒØ§Ø±Øª Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ -->
                <div class="glass-panel p-6 rounded-3xl text-center relative overflow-hidden bg-white/80 backdrop-blur-md">
                    <div class="relative w-24 h-24 mx-auto mb-3 group">
                        <img id="user-avatar" src="images/ui/logo.png" class="w-full h-full rounded-full object-cover border-4 border-white/50 shadow-md transition duration-300">
                        <label for="avatar-upload" class="absolute bottom-0 right-0 bg-emerald-500 hover:bg-emerald-600 text-white p-2 rounded-full border-2 border-white cursor-pointer shadow-sm z-10 transition transform hover:scale-110" title="ØªØºÙŠÙŠØ± Ø§Ù„ØµÙˆØ±Ø©">
                            <i data-lucide="camera" class="w-4 h-4"></i>
                        </label>
                        <input type="file" id="avatar-upload" accept="image/*" class="hidden">
                    </div>
                    <h2 id="user-name-display" class="text-xl font-black text-emerald-900 mb-1">...</h2>
                    <p id="user-email-display" class="text-xs text-slate-500 font-bold truncate mb-6">...</p>

                    <nav class="space-y-2">
                        <button onclick="showSection('dashboard')" class="w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl bg-emerald-600 hover:bg-emerald-700 text-white font-bold shadow-lg shadow-emerald-200 transition mb-4">
                            <i data-lucide="layout-grid" class="w-5 h-5"></i> Ù„ÙˆØ­ØªÙŠ
                        </button>
                        <button onclick="showSection('ramadan')" class="w-full flex items-center justify-between px-4 py-3 rounded-lg hover:bg-emerald-50 text-emerald-800 font-bold transition text-sm group border border-emerald-100 mb-2">
                            <span class="flex items-center gap-2"><i data-lucide="moon" class="w-4 h-4 group-hover:text-emerald-600"></i> ØªØ­Ø¯ÙŠ Ø±Ù…Ø¶Ø§Ù†</span>
                            <i data-lucide="chevron-left" class="w-4 h-4 text-emerald-300"></i>
                        </button>
                        <button onclick="showSection('settings')" class="w-full flex items-center justify-between px-4 py-2 rounded-lg hover:bg-slate-50 text-slate-600 font-bold transition text-sm group">
                            <span class="flex items-center gap-2"><i data-lucide="user-cog" class="w-4 h-4 text-slate-400 group-hover:text-emerald-600"></i> Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø¨</span>
                            <i data-lucide="chevron-left" class="w-4 h-4 text-slate-300"></i>
                        </button>
                        <button onclick="firebase.auth().signOut().then(() => window.location.href='index.html')" class="w-full flex items-center gap-2 px-4 py-2 rounded-lg text-red-500 hover:bg-red-50 font-bold transition text-sm mt-4">
                            <i data-lucide="log-out" class="w-4 h-4"></i> Ø®Ø±ÙˆØ¬
                        </button>
                    </nav>
                </div>
            </div>

            <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ -->
            <div class="lg:col-span-3 space-y-6">
                
                <!-- 1. Ù‚Ø³Ù… Ù„ÙˆØ­ØªÙŠ -->
                <div id="section-dashboard" class="content-section space-y-6">
                    <!-- Ø¨Ø§Ù†Ø± Ø±Ù…Ø¶Ø§Ù† -->
                    <div class="bg-gradient-to-r from-emerald-600 to-teal-700 text-white p-6 rounded-3xl shadow-lg relative overflow-hidden group cursor-pointer" onclick="showSection('ramadan')">
                        <div class="absolute top-0 left-0 p-4 opacity-10"><i data-lucide="moon" class="w-32 h-32"></i></div>
                        <div class="relative z-10 flex justify-between items-center">
                            <div>
                                <h3 class="text-xl font-black mb-1">ØªØ²ÙƒÙŠØ© Ø§Ù„Ù†ÙØ³ ÙÙŠ Ø±Ù…Ø¶Ø§Ù† ğŸŒ™</h3>
                                <p class="text-emerald-100 text-sm font-bold">Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ù…ØªØ§Ø¨Ø¹Ø© ÙˆØ±Ø¯Ùƒ Ø§Ù„ÙŠÙˆÙ…ÙŠ (Ù‚Ø±Ø¢Ù†ØŒ ØµÙ„Ø§Ø©ØŒ Ø£Ø°ÙƒØ§Ø±)</p>
                            </div>
                            <div class="bg-white/20 p-2 rounded-xl backdrop-blur-sm">
                                <i data-lucide="arrow-left" class="w-6 h-6"></i>
                            </div>
                        </div>
                    </div>

                    <!-- Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª -->
                    <div>
                        <h3 class="font-bold text-emerald-900 mb-4 flex items-center gap-2 text-lg">
                            <i data-lucide="play-circle" class="text-emerald-600"></i> ÙƒÙˆØ±Ø³Ø§ØªÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                        </h3>
                        <div id="my-courses-list" class="space-y-4">
                            <!-- Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª Ø¨ØªØªØ­Ù…Ù„ Ù‡Ù†Ø§ -->
                        </div>
                    </div>
                </div>

                <!-- 2. Ù‚Ø³Ù… ØªØ­Ø¯ÙŠ Ø±Ù…Ø¶Ø§Ù† (Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯) -->
                <div id="section-ramadan" class="content-section hidden space-y-6">
                    <!-- Ù…Ù„Ø®Øµ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                        <div class="flex justify-between items-end mb-2">
                            <div>
                                <h3 class="text-lg font-bold text-gray-700">Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„ÙŠÙˆÙ… <span id="current-ramadan-date" class="text-sm font-normal text-gray-400 mr-2">...</span></h3>
                                <p class="text-sm text-gray-500" id="progress-text">Ø´Ø¯ Ø­ÙŠÙ„Ùƒ ÙŠØ§ Ø¨Ø·Ù„ ğŸ’ª</p>
                            </div>
                            <span class="text-3xl font-bold text-[#047857]" id="progress-percent">0%</span>
                        </div>
                        <div class="w-full bg-gray-100 rounded-full h-3">
                            <div class="bg-[#047857] h-3 rounded-full transition-all duration-700 ease-out" id="progress-bar" style="width: 0%"></div>
                        </div>
                        
                        <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø£ÙŠØ§Ù… -->
                        <div class="flex gap-2 overflow-x-auto pb-2 mt-6" id="ramadan-days-scroller">
                            <!-- Ø§Ù„Ø£ÙŠØ§Ù… Ù‡ØªØªÙˆÙ„Ø¯ Ù‡Ù†Ø§ -->
                        </div>
                    </div>

                    <!-- Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª -->
                    <div class="flex items-center gap-2 mb-2">
                        <div class="w-1 h-6 bg-[#047857] rounded-full"></div>
                        <h3 class="text-xl font-bold text-gray-800">Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª (Ø§Ù„Ø«ÙˆØ§Ø¨Øª) ğŸ•Œ</h3>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <!-- Ø§Ù„ØµÙ„ÙˆØ§Øª -->
                        <div id="prayers-container" class="contents"></div>
                        
                        <!-- ÙˆØ±Ø¯ Ø§Ù„Ù‚Ø±Ø¢Ù† -->
                        <div class="stat-card quran-card p-5 rounded-xl shadow-sm flex flex-col justify-between relative group cursor-pointer" onclick="toggleQuran()">
                            <div class="relative z-10">
                                <div class="flex justify-between items-start">
                                    <div>
                                        <h4 class="font-bold text-lg text-white">ÙˆØ±Ø¯ Ø§Ù„Ù‚Ø±Ø¢Ù†</h4>
                                        <p class="text-emerald-100 text-sm mt-1" id="quran-status-text">Ø§Ø¶ØºØ· Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙˆØ±Ø¯ ğŸ“–</p>
                                    </div>
                                    <div class="p-2 bg-white/20 rounded-lg backdrop-blur-sm">
                                        <i data-lucide="book-open" class="text-white"></i>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4 flex items-center gap-3 relative z-10">
                                <div id="quran-check-circle" class="w-8 h-8 rounded-full border-2 border-white/50 flex items-center justify-center transition-all">
                                    <i data-lucide="check" class="w-5 h-5 text-white opacity-0 transition-opacity"></i>
                                </div>
                                <span class="text-sm font-semibold text-white" id="quran-action-text">Ù„Ù… ÙŠØªÙ… Ø¨Ø¹Ø¯</span>
                            </div>
                        </div>
                    </div>

                    <!-- Ø§Ù„Ù†ÙˆØ§ÙÙ„ -->
                    <div class="flex justify-between items-center mb-2 mt-8">
                        <div class="flex items-center gap-2">
                            <div class="w-1 h-6 bg-[#D4AF37] rounded-full"></div>
                            <h3 class="text-xl font-bold text-gray-800">Ø§Ù„Ù†ÙˆØ§ÙÙ„ (Ø²ÙŠØ§Ø¯Ø© Ø®ÙŠØ±) ğŸŒ±</h3>
                        </div>
                        <button onclick="toggleSettingsModal()" class="text-sm text-[#047857] hover:bg-[#ECFDF5] px-3 py-1.5 rounded-lg transition-colors flex items-center gap-1">
                            <i data-lucide="sliders-horizontal" class="w-4 h-4"></i> ØªØ¹Ø¯ÙŠÙ„
                        </button>
                    </div>

                    <div id="flexible-habits-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                    <div id="empty-habits-msg" class="hidden text-center p-8 bg-gray-50 rounded-xl border border-dashed border-gray-300">
                        <p class="text-gray-500">Ù…Ø´ Ù…ÙØ¹Ù„ Ø£ÙŠ Ø³Ù†Ù†.. Ø±ÙƒØ² ÙÙŠ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ÙˆÙ…Ù…ØªØ§Ø² Ø¹Ù„ÙŠÙƒ! ğŸ‘Œ</p>
                    </div>
                </div>

                <!-- 3. Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
                <div id="section-settings" class="content-section hidden">
                    <div class="glass-panel p-8 rounded-3xl">
                        <h2 class="text-xl font-black text-emerald-900 mb-6">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
                        <form id="profile-form" class="space-y-4">
                            <div><label class="block text-slate-700 font-bold mb-2 text-sm">Ø§Ù„Ø§Ø³Ù…</label><input type="text" id="edit-name" class="w-full bg-white border border-slate-200 rounded-xl px-4 py-3 outline-none"></div>
                            <button type="submit" class="bg-emerald-600 text-white px-6 py-3 rounded-xl font-bold w-full text-sm">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†ÙˆØ§ÙÙ„ -->
    <div id="settings-modal" class="fixed inset-0 bg-black/50 z-50 hidden flex items-center justify-center backdrop-blur-sm">
        <div class="bg-white rounded-2xl w-full max-w-md mx-4 shadow-2xl overflow-hidden animate-[fadeIn_0.2s_ease-out]">
            <div class="p-5 border-b border-gray-100 flex justify-between items-center bg-[#ECFDF5]">
                <h3 class="font-bold text-[#047857] text-lg">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ§ÙÙ„ ğŸ› ï¸</h3>
                <button onclick="toggleSettingsModal()" class="text-gray-500 hover:text-red-500"><i data-lucide="x"></i></button>
            </div>
            <div class="p-6 max-h-[60vh] overflow-y-auto" id="settings-list"></div>
            <div class="p-5 border-t border-gray-100 flex justify-end bg-gray-50">
                <button onclick="toggleSettingsModal()" class="bg-[#047857] text-white px-6 py-2 rounded-xl font-bold">ØªÙ…</button>
            </div>
        </div>
    </div>

    <div id="footer-ph"></div>
</body>
</html>